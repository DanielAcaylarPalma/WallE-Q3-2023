START CONTROL,
*PROJECT WALL-E

! C = P_WALLE_2021Q3.ASC;P_WALLE_2021Q4.ASC;P_WALLE_2022Q1.ASC;P_WALLE_2022Q2.ASC;P_WALLE_2022Q3.ASC;P_WALLE_2022Q4.ASC;WALLEQ1_MAINONLY_JAN.ASC,
! C = WALLEQ1_MAINONLY_JAN.ASC;WALLEQ1_MAINONLY_FEB.ASC,
C = WALLE_Q3_JUL_MAINONLY.ASC;WALLE_Q3_AUG_MAINONLY.ASC;WALLE_Q3_SEP_MAINONLY.ASC,

Y,
CEP,
BIG,
TIDY,
CSVR2,
OLDNAMES,
FINISH CONTROL,

START DATA,
ORDER1234567890XV,
SERIAL NUMBER IN COLUMNS 1-10,
CARD CHARACTERS BINARY 300000,
TEMPORARY /99999999/,

DI $RESP = $1-10,

di $blank = 0,
di $Blankamt = $299996-300000,

[*INSERT WallE_insertGlobal]
[*INSERT WallE_oesoe]

[*INSERT WallE_resp]

[*INSERT walle_cardcol_banner]
[*INSERT walle_cardcol_p1]
! INSERT WallE_insertAlign_pickup_dashboard
[*INSERT WallE_insertAlign1_dashboard]



[*INSERT WallE_stubs_pickup_dashboard]
[*INSERT WallE_stubs1_dashboard]

!INSERT WallE_insertAligna


!INSERT walle_cardcol_p2
!INSERT walle_cardcol_p3



!INSERT WallE_stubsa1



! INSERT WALLE_HEADERS_Trend
!INSERT WALLE_HEADERS_Trend_BACKUP


[*INSERT WALL_E_NEWWTS]

DM $MAR2023onwards = 
$resp/28828692+28828693+28828694+28828695+28828696+28830331+28830734+28830735+28830736+28831003+28831004+28832692+28832693+28832694+28832695+28832696+28832697+28832698+28833546+28833547+28834056+28835539+28835540+28835541+28835542+28835543+28839218+28839219+28839220+28839221+28840639+28841761+28841762+28841763+28843542+28843543+28843544+28843545+28843722+28843723+28843724+28843734+28843735+28843736+28844322+28844323+28844324+28844880+28844881+28844882+28844883+28844885+28845128+28845129+28845130+28845131+28845204+28845317+28845318+28845319+28845320+28845366+28845367+28845368+28845468+28845469+28845470+28846724+28846725+28846726+28846727+28846777+28846778+28846779+28847791+28847792+28850500+28850501+28850592+28850593+28850594+28850595+28850596+28850598+28850749+28850750+28850903+28850904+28850905+28850906+28852864+28854110+28854411+28857557+28857558+28857559+28858034+28858035+28858036+28858039+28858040+28858041+28858042+28858219+28858355+28858809+28858811+28858813+28858814+28858816+28858962+28860506+28860954+28863329+28863331+28865891+28865892+28866724+28866725+28866726+28866727+28868131+28868132+28868133+28868134+28868137+28868138+28870046+28870048+28870049+28870180+28870181+28870182+28870183+28870413+28870416+28870417+28870418+28870419+28871347+28871348+28871349+28871350+28871351+28871352+28872277+28873224+28873225+28873226+28873227+28874257+28874258+28874259+28874471+28874472+28874473+28874909+28874910+28874911+28874912+28874913+28875460+28875461+28876126+28876127+28876128+28876129+28876130+28876131+28876132+28876133+28876755+28877453+28877454+28877455+28877456+28877457+28877613+28878115+28878116+28878117+28878118+28878119+28879975+28879976+28879977+28879978+28879979+28879980+28879981+28879982+28880863+28881532+28881533+28881534+28881535+28881536+28881537+28881538+28885018+28885019+28885020+28885500+28885501+28885528+28885529+28886447+28886448+28888652+28888653+28888656+28888834+28888835+28888836+28888837+28889006+28889007+28889008+28889009+28889010+28889011+28889013+28889215+28889216+28889217+28889218+28889334+28889335+28889337+28889338+28889339+28889340+28889342+28889343+28889344+28889595+28890033+28890034+28890035+28891332+28891396+28891397+28891398+28891399+28891400+28891401+28891402+28891403+28891404+28891453+28891454+28899597+28899598+28901390+28901391+28901392+28901492+28901640+28901641+28902426+28902427+28902428+28903428+28903429+28903430+28906110+28906111+28906141+28907664+28907666+28909592+28909593+28913740+28917056+28917057+28917058+28917602+28918036+28918037+28920103+28920104+28920105+28920106+28920646+28920648+28920649+28920650+28920837+28920838+28920839+28920840+28920841+28920842+28920971+28921013+28921014+28921160+28921202+28921203+28921204+28921205+28922238+28924040+28924041+28924042+28927003+28927004+28927005+28927871+28934322+28934508+28934509+28934510+28934996+28934997+28935675+28936139+28936141+28939892+28944015+28945426+28945427+28945428+28946009+28947865+28947866+28949143+28949144+28949145+28949146+28949147+28949148+28949149+28949346+28974940+28974941+28974942+28974943+28977205+28985114+28985116+28987688+28987689+28987691+28992397+28992398+28992399+28992400+28992401+28992695+28992696+28992697+28992698+28992699+28992801+28992917+28992918+28993453+28993454+28993455+28993654+28994309+28994310+28994311+28994312+29009281+29037757+29037758+29045023+29045024+29045026+29052540+29052541+29052542+29054435+29054436+29056959+29056960+29057363+29057364+29057365+29069238+29071526+29071527+29077449+29077450+29077451+29077452+29077454+29078074+29078075+29078076+29078077+29079275+29079660+29080758+29080759+29080760+29080855+29080856+29081309+29081310+29081312+29081313+29081315+29081552+29081836+29081837+29083582+29083586+29085803+29085804+29085805+29085807+29086378+29086379+29086380+29086381+29086382+29086383+29086384+29089845+29089846+29089847+29089848+29092253+29092254+29093392+29094117+29094118+29094119+29094540+29094541+29094542+29094543+29094918+29095894+29095917+29095918+29096083+29096084+29096085+29096086+29096288+29096869+29096870+29097435+29097436+29097437+29097527+29097528+29098557+29099874+29099875+29099876+29099877+29099878+29100249+29100250+29100251+29101081+29101082+29103589+29103645+29103848+29104589+29104590+29104591+29104592+29106847+29111100+29111161+29111162+29111163+29118730+29119010+29119011+29119652+29119653+29123378+29123379+29123380+29128644+29128645+29128697+29128698+29128849+29131271+29131272+29131273+29131612+29132579+29132580+29132581+29132582+29132636+29134810+29134811+29134812+29134813+29137837+29138614+29138615+29139189+29141798+29141799+29141800+29141801+29145984+29145985+29145986,

DM $HT = T,

HT = 'TOTAL',
 H = 'TOTAL',
 
! DM $HDboard = 
! T,
! $JAN2022/NB,
! $FEB2022/NB,
! $MAR2022/NB,
! $APR2022/NB,
! $MAY2022/NB,
! $JUN2022/NB,
! $JUL2022/NB,
! $AUG2022/NB,
! $SEP2022/NB,
! $OCT2022/NB,
! $NOV2022/NB,
! $DEC2022/NB,
! $JAN2023/NB,
! $FEB2023/NB,
! $MAR2023/NB,
! $APR2023/NB,
! $MAY2023/NB,
! $JUN2023/NB,
! $JUL2023/NB,
! $AUG2023/NB,


! $JAN2022/NB+$FEB2022/NB+$MAR2022/NB,
! $APR2022/NB+$MAY2022/NB+$JUN2022/NB,
! $JUL2022/NB+$AUG2022/NB+$SEP2022/NB,
! $OCT2022/NB+$NOV2022/NB+$DEC2022/NB,
! $JAN2023/NB+$FEB2023/NB+$MAR2023/NB,
! $APR2023/NB+$MAY2023/NB+$JUN2023/NB,
! $JUL2023/NB+$AUG2023/NB,

! HT = "HEADER DASHBOARD",
! H = "
! TOTAL;

! JAN 2022;
! FEB 2022;
! MAR 2022;

! APR 2022;
! MAY 2022;
! JUN 2022;

! JUL 2022;
! AUG 2022;
! SEP 2022;

! OCT 2022;
! NOV 2022;
! DEC 2022;

! JAN 2023;
! FEB 2023;
! MAR 2023;

! APR 2023;
! MAY 2023;
! JUN 2023;

! JUL 2023;
! AUG 2023;

! Q1 2022;
! Q2 2022;
! Q3 2022;
! Q4 2022;
! Q1 2023;
! Q2 2023;
! Q3 2023",
 
DM $HDboard = 
T,
$SEP2023/NB,


$JUL2023/NB+$AUG2023/NB+$SEP2023/NB,

HT = "HEADER DASHBOARD",
H = "
TOTAL;
SEP 2023;

Q3 2023",
DM $GCASH_USER = $xA_Q17e/1,
DM $USER = $xQ17i/1,



[*DATA brladdertitle (;) = 
Total Awareness;
Aided;
Other spontaneous;
TOM;
First Ever Tried;
Ever Tried;
P6M;
With Existing Acc;
P2M;
P4W;
BUMO;
2nd Favorite;
Favorite;
Recommended]

[*DATA brladdervar (;) = 
TotAware;
Aided;
Otherspont;
TOM;
FirstEverTried;
EverTried;
P6M;
WithExistingAcc;
P2M;
P4W;
BUMO;
SecondFavorite;
Favorite;
Recommended]

[*DO B = 1:[brladdervar.#]:1]
DM $RAW[brladdervar.B] = 
[*FOR A = 7:9:11:6:10:8:5:2:4]
$NOM_LAD[A]/[B],
[*END A]

XT = "[brladdertitle.B]",
X = "
[*FOR A = 7:9:11:6:10:8:5:2:4]
[NOM2.A][*SLE];
[*END A]",
[*END B]

[*DATA RAWSEC = 
Total SEC,
ABC1,
C2,
D]

DM $RAWSEC = 
$xQ102/
1..4,
1..2,
3,
4,


DM $RAWSECTABLES =
$xQ102/1..4,
1,
2,
1..2,
3,
4,

[*DATA RAWSECTABLES = 
Total SEC,
AB,
C1,
ABC1,
C2,
D]

[*DATA RAWLIFESTAGE = 
Total Lifestage,
Youth (21 yo below),
Yuppies (22-29 yo),
Transitioners (30-34 yo),
Balancers (35-44 yo),
Older Adults/Retirees (45 yo above)]

DM $RAWLIFESTAGE = 
$T_Q1_1/1..99,
$T_Q1_1/1..21,
$T_Q1_1/22..29,
$T_Q1_1/30..34,
$T_Q1_1/35..44,
$T_Q1_1/45..99,



[*DATA RAWREGION = 
Total Region,
MMA,
NCL,
SL,
VIS,
MIN]

DM $RAWREGION =
$Q3/
1..17,
1,
2+3+4+5,
6+7+8,
9+10+11,
12+13+14+15+16+17,



[*DATA RAWUSERSHIP = 
Total Usership,
User,
Non-user]


DM $RAWUSERSHIP = 
$TQ17i/1..2,1-2,

[*DATA RAWNPS = Detractors,
Passives,
Promoters,
NPS]

[*DO A=1:4]
DM $RAWNPS[A] = 
		$TQ47R1/[A+11].($FQ47/1),
		$TQ47R2/[A+11].($FQ47/2),
		$TQ47R23/[A+11].($FQ47/23),
		$TQ47R3/[A+11].($FQ47/3),
		$TQ47R4/[A+11].($FQ47/4),
		$TQ47R7/[A+11].($FQ47/7),
		$TQ47R11/[A+11].($FQ47/11),
		$TQ47R13/[A+11].($FQ47/13),
		$TQ47R12/[A+11].($FQ47/12),
[*END A]



[*DATA RAWGENDER = 
Total Gender,
Male,
Female]


DM $RAWGENDER = 
$Q2/1..2,1-2,



[*DATA RAWEMPLOYMENTSTAT = 
Total Employment Status,
Working,
Not Working]


DM $RAWEMPLOYMENTSTAT = 
$xSEC21/1..2,1-2,


[*DATA RAWSOURCEOFINCOME (;)=
TOTAL SOURCE OF INCOME;
Salary from employment;
Salary from Part-time job;
Own Business;
Remittance from family member;
Government allowance;
Borrow money from other people;
Debt from formal Institutions;
Pension;
Personal savings;
Income from self-employment;
Allowance;
SALARY OF MEMBER (NET)<Q>;
Salary from my husband/Wife;
Salary of my children;
Salary of my Mother/Father;
ONLINE GAMES (NET)<Q>;
ONLINE SABONG;
Payments from games tournament;
online games;
No source of income]

DM $RAWSOURCEOFINCOME = $TQ75/2..21,2-21,


[*DATA brandDashboard (;) = 
GCash;
PayMaya/Maya;
ShopeePay;
Coins.ph;
PayPal;
GrabPay;
CliQQ;
BDO Mobile;
BPI Mobile]

[*FORA=1:3:4:5:6:7:8:10:11:12:13:14:16:17:20:21:22:23:24:25:26:27:28:29:30]
DM $RAWASSOC[A] = 
		$xT_Q64_[A]/5,
		$xT_Q64_[A]/7,
		$xT_Q64_[A]/9,
		$xT_Q64_[A]/4,
		$xT_Q64_[A]/8,
		$xT_Q64_[A]/6,
		$xT_Q64_[A]/3,
		$xT_Q64_[A]/1,
		$xT_Q64_[A]/2,
[*END A]

[*SK 300]
[*300]
[*DO B = 1:[brladdervar.#]:1]
[*DO C = 1:[RAWSEC.#]:1]
[*DO D = 1:[RAWLIFESTAGE.#]:1]
[*DO E = 1:[RAWREGION.#]:1]
[*DO F = 1:[RAWUSERSHIP.#]:1]
DM $T[brladdervar.B][&C][&D][&E][&F] =
[*DO A = 1:9] 
$RAW[brladdervar.B]/[A],
[*END A]
R,
X = "
[*FOR A = 7:9:11:6:10:8:5:2:4]
[brladdertitle.B]%[NOM2.A]%[RAWSEC.C]%[RAWLIFESTAGE.D]%[RAWREGION.E]%[RAWUSERSHIP.F];
[*END A]
MISSING<Z><S>",
[*END F]
[*END E]
[*END D]
[*END C]
[*END B]

[*DO A = 1:9]
[*DO C = 1:[RAWSEC.#]:1]
[*DO D = 1:[RAWLIFESTAGE.#]:1]
[*DO E = 1:[RAWREGION.#]:1]
[*DO F = 1:[RAWUSERSHIP.#]:1]
DM $TRAWNPS[A][&C][&D][&E][&F] =
[*DO G = 1:4] 
$RAWNPS[G]/[A],
[*END G]
R,
X = "
[*DO G = 1:4]
[RAWNPS.G]%[brandDashboard.A]%[RAWSEC.C]%[RAWLIFESTAGE.D]%[RAWREGION.E]%[RAWUSERSHIP.F];
[*END G]
MISSING<Z><S>",
[*END F]
[*END E]
[*END D]
[*END C]
[*END A]

[*DO A = 1:9]
[*DO C = 1:[RAWSEC.#]:1]
[*DO D = 1:[RAWLIFESTAGE.#]:1]
[*DO E = 1:[RAWREGION.#]:1]
[*DO F = 1:[RAWUSERSHIP.#]:1]
DM $TRAWASSOC[A][&C][&D][&E][&F] =
[*FORG=1:3:4:5:6:7:8:10:11:12:13:14:16:17:20:21:22:23:24:25:26:27:28:29:30]
$RAWASSOC[G]/[A],
[*END G]
R,
X = "
[*FORG=1:3:4:5:6:7:8:10:11:12:13:14:16:17:20:21:22:23:24:25:26:27:28:29:30]
AWARE%[ATTRIBS.G]%[brandDashboard.A]%[RAWSEC.C]%[RAWLIFESTAGE.D]%[RAWREGION.E]%[RAWUSERSHIP.F];
[*END G]
MISSING<Z><S>",
[*END F]
[*END E]
[*END D]
[*END C]
[*END A]

[*DO A = 1:9]
[*DO C = 1:[RAWSEC.#]:1]
[*DO D = 1:[RAWLIFESTAGE.#]:1]
[*DO E = 1:[RAWREGION.#]:1]
[*DO F = 1:[RAWUSERSHIP.#]:1]
DM $TRAWASSOp[A][&C][&D][&E][&F] =
[*FORG=1:3:4:5:6:7:8:10:11:12:13:14:16:17:20:21:22:23:24:25:26:27:28:29:30]
$RAWASSOC[G]/[A],
[*END G]
R,
X = "
[*FORG=1:3:4:5:6:7:8:10:11:12:13:14:16:17:20:21:22:23:24:25:26:27:28:29:30]
P2M%[ATTRIBS.G]%[brandDashboard.A]%[RAWSEC.C]%[RAWLIFESTAGE.D]%[RAWREGION.E]%[RAWUSERSHIP.F];
[*END G]
MISSING<Z><S>",
[*END F]
[*END E]
[*END D]
[*END C]
[*END A]


! IF $MAR2023onwards/NB, WRITE,
FINISH DATA,
START TABLES,


!!!!!!!!!!!!!!!!
!!!!!FORMAT!!!!!
!!!!!!!!!!!!!!!!





GLOBAL IT # = '<JL>Wall-E',



!======FOR QPS WINDOWS (% + raw - for datachecking)
F= CTU'='/CAZ'-'/CZP'-'/SDV/UCH/NPGN/NPTC/TID/RLW30/LBB1/TOC/SPL250/CNZ'*'/URS/
  DPR1/PCS/BRS/BCS/PRC/BTS/LPP55/NSER/CLG1/RNC1/NDAT/NPGN/BAL/RBL/BCS/BTS/CLW9/PBL/MOD,

F=SDV,		! ------ PRINT STD DEVIATION
F=DPR4,		! ------ DECIMAL %
F=DPT0,		! ------ DECIMAL RAW COUNT
F=DPA4,		! ------ DECIMAL MEAN,SUM..
F=DPS4,	        ! ------ DECIMAL STD,
F=MOD,		! ------ DISPLAY MODE
F=MED,		! ------ DISPLAY MEDIAN
!F=MCB29,          ! ------ Less than 30 base
F=BTS,                  ! ------ Blank Tables Suppress
F=nBCS,                  ! ------ Blank Column Suppress
F=NBRS,                  ! ------ Blank Row Suppress
F=PBL/MOD,

%AVG = 'Mean score<D2>',
%DAT = '<&DD>/<&MONTH>/<&YY>',
%RTH = '<ML3>ROW %',
%RTV = '<ML3>COL %',
%PRC = '<ML3>COUNT',
%SER = '<ML3>STD ERR OF MEAN',
%SDV ='STANDARD DEVIATION',
%PTR = "TOTAL",
!%AVG ='MEAN SCORE',
%SDV ='STANDARD DEVIATION',
%MED = '<ML7>MEDIAN            ',
%UNR = '<ML7>(UNWEIGHTED BASE)',


  
F=SHG1/SIG/SLA95/SLB95/BRS/FSL,  !---------SIGTEST

!F=NRTV, ! ------- ONLY COUNT
!F=NPRC, ! -------- ONLY %



SELECT WR $newwts,


F=BRS,


[*SET T = 0]



[*SK 5]
[*5]
[*DO B = 1:[brladdervar.#]:1]
[*SK 200 ON B.EQ.5][*SK 200 ON B.EQ.12]
[*DO C = 1:[RAWSEC.#]:1]
[*DO D = 1:[RAWLIFESTAGE.#]:1]
[*DO E = 1:[RAWREGION.#]:1]
[*DO F = 1:[RAWUSERSHIP.#]:1]
IF $RAWSEC/[C].$RAWLIFESTAGE/[D].$RAWREGION/[E].$RAWUSERSHIP/[F], T # [+T] = $T[brladdervar.B][&C][&D][&E][&F] * $HDboard,
[*END F]
[*END E]
[*END D]
[*END C]
[*200]
[*END B]


[*DO A = 1:9]
[*DO C = 1:[RAWSEC.#]:1]
[*DO D = 1:[RAWLIFESTAGE.#]:1]
[*DO E = 1:[RAWREGION.#]:1]
[*DO F = 1:[RAWUSERSHIP.#]:1]
IF ($RAWTOTAWARE/[A]).($RAWWithExistingAcc/[A]+$RAWP2M/[A]).$RAWSEC/[C].$RAWLIFESTAGE/[D].$RAWREGION/[E].$RAWUSERSHIP/[F], T # [A][&C][&D][&E][&F] = $TRAWNPS[A][&C][&D][&E][&F] * $HDboard,
[*END F]
[*END E]
[*END D]
[*END C]
[*END A]

[*DO A = 1:9]
[*DO C = 1:[RAWSEC.#]:1]
[*DO D = 1:[RAWLIFESTAGE.#]:1]
[*DO E = 1:[RAWREGION.#]:1]
[*DO F = 1:[RAWUSERSHIP.#]:1]
IF ($RAWTOTAWARE/[A]).$RAWSEC/[C].$RAWLIFESTAGE/[D].$RAWREGION/[E].$RAWUSERSHIP/[F], T # [+T] = $TRAWASSOC[A][&C][&D][&E][&F] * $HDboard,
[*END F]
[*END E]
[*END D]
[*END C]
[*END A]




FINISH TABLES,


START MANIP,

[*do A = 1:9]
[*DO C = 1:[RAWSEC.#]:1]
[*DO D = 1:[RAWLIFESTAGE.#]:1]
[*DO E = 1:[RAWREGION.#]:1]
[*DO F = 1:[RAWUSERSHIP.#]:1]
 MT #[A][&C][&D][&E][&F](R4) = #[A][&C][&D][&E][&F](R3)-#[A][&C][&D][&E][&F](R1),
[*END F]
[*END E]
[*END D]
[*END C]
[*end A]
[*SK 5]
[*5]

FINISH MANIP,

