START CONTROL,
*PROJECT WALL-E


!C = P_WALLE_2022Q1.ASC;P_WALLE_2022Q2.ASC;P_WALLE_2022Q3.ASC;P_WALLE_2022Q4.ASC;P_WALLE_2023Q1.ASC;P_WALLE_2023Q2_PUNCHED.ASC,

!C = P_WALLE_2023Q2_PUNCHED.ASC,

!C = WALLEQ1_MAINONLY_PUNCHED.ASC,

!C = P_WALLE_2022Q2.ASC,

C = P_WALLE_2023Q3.ASC,


Y,
CEP,
CSVR2,
TERSE,

OLDNAMES,
FINISH CONTROL,

START DATA,
ORDER1234567890XV,
SERIAL NUMBER IN COLUMNS 1-10,
CARD CHARACTERS BINARY 300000,
TEMPORARY /99999999/,

DI $RESP = $1-10,

di $blank = 0,

DJ $DATE = $190-195,


[*INSERT WallE_insertGlobal]
[*INSERT WallE_oesoe]
[*INSERT WallE_resp]

[*INSERT walle_cardcol_banner]
[*INSERT walle_cardcol_p1]
[*INSERT walle_cardcol_p6]

[*INSERT WallE_insertAlign_pickup]
[*INSERT WallE_insertAlign6]

[*INSERT WallE_stubs_pickup]
[*INSERT WallE_stubs6]



!*INSERT WALLE_HEADERS
[*INSERT WALLE_HEADERS_Trend]

[*INSERT WALL_E_NEWWTS]

DM $Apr16to30fort = 
$resp/29491513+29491586+29503872+29505939+29520493+29524386+29525024+29529966+29533941+29534331+29534332+29539416+29539753+29539754+29539755+29544637+29544638+29544653+29544655+29545286+29552465+29552466+29552468+29552666+29556666+29556667+29556668+29556671+29557796+29562393+29563814+29567025+29571878+29576546+29578918+29578919+29578920+29578921+29578922+29580155+29580156+29580157+29588340+29588341+29588856+29589377+29589378+29589380+29590635+29592946+29592951+29595143+29595144+29595438+29595445+29598566+29598567+29598662+29599099+29599678+29600069+29600632+29600636+29604733+29604734+29605843+29606306+29606308+29606310+29606328+29606335+29609003+29609346+29609351+29609700+29609701+29609964+29610092+29610093+29612252+29612253+29612725+29612726+29612727+29615762+29615764+29615777+29616272+29617501+29617504+29618005+29621166+29622751+29622752+29623782+29623783+29623784+29625452+29629283+29629423+29631649+29631933+29631934+29631935+29631937+29632150+29632151+29632721+29632722+29634849+29634850+29634851+29635346+29636590+29641523+29641524+29641525+29644460+29646943+29648213+29648523+29648914+29649422+29650087+29650088+29650347+29652066+29652458+29652459+29652560+29652653+29653914+29655866+29655870+29655871+29657716+29657717+29657719+29659088+29660629+29660630+29660667+29660669+29662102+29663016+29665399+29665400+29665831+29665832+29667332+29667334+29667934+29668118+29669140+29672109+29672111+29672456+29672459+29674103+29674133+29674134+29674226+29674227+29674463+29674628+29674629+29675179+29675181+29675186+29678244+29682105+29682106+29682107+29682193+29682289+29683115+29683116+29684889+29686149+29686150+29688438+29688440+29691296+29692092+29697185+29699643+29699757+29701588+29703520+29704509+29739903+29770967+29770969+
29503871+29503873+29503874+29520043+29520873+29521210+29524385+29525023+29529965+29529967+29529968+29534333+29534334+29542988+29544639+29544654+29544656+29552467+29552667+29552668+29552669+29552670+29556669+29556670+29556672+29557799+29557800+29557801+29558050+29562390+29562391+29562392+29562394+29562395+29562396+29567024+29567027+29570697+29572219+29576426+29578916+29579860+29580152+29580153+29580159+29580160+29581171+29581172+29581174+29582184+29584782+29584783+29584784+29584810+29585329+29585330+29585331+29585332+29585333+29585334+29585335+29587816+29587817+29587818+29588342+29588854+29588857+29588858+29588859+29589358+29589359+29589360+29589376+29589379+29589381+29589382+29590633+29590634+29590636+29590944+29590945+29590946+29590947+29592945+29592952+29592953+29592955+29592956+29595139+29595141+29595142+29595439+29595441+29595442+29595443+29595444+29596980+29598564+29598565+29599038+29599039+29599761+29599762+29599763+29599764+29600070+29600633+29600634+29600635+29600637+29600638+29601030+29601568+29601569+29604735+29604946+29605011+29605603+29605630+29606305+29606307+29606309+29606332+29606333+29606334+29606336+29609002+29609008+29609010+29609349+29609352+29609965+29609966+29610094+29610197+29611960+29611961+29612254+29615760+29615763+29616228+29616273+29617417+29617500+29617862+29622749+29622750+29629448+29629461+29629694+29630909+29630910+29630911+29630912+29630913+29630914+29631650+29633670+29633671+29634847+29634848+29634852+29636589+29638399+29638401+29639451+29639452+29646949+29648171+29648172+29648214+29648522+29648524+29650346+29650348+29650980+29650981+29651426+29651427+29651428+29651429+29651430+29651431+29651433+29652065+29652456+29652457+29652561+29653912+29653913+29653915+29657589+29657718+29659085+29659087+29660627+29660628+29660631+29660633+29660634+29660668+29661492+29661493+29661494+29661495+29661496+29661497+29661517+29661519+29662016+29662265+29662652+29662653+29662810+29663017+29664967+29667333+29667931+29667932+29667933+29667935+29667936+29668117+29668119+29669141+29669142+29669680+29669685+29669947+29669948+29669949+29669950+29670378+29670379+29670380+29670381+29670829+29671442+29671444+29671445+29671446+29671523+29671612+29671660+29672110+29672112+29672113+29672114+29674102+29674627+29674649+29675183+29675184+29678243+29680461+29680462+29680463+29680464+29680465+29680466+29680467+29680469+29680470+29680929+29680930+29682157+29682176+29682178+29682194+29683113+29683114+29684508+29684883+29684884+29684885+29684886+29684887+29684888+29685297+29687709+29688437+29688439+29690644+29690645+29690646+29691230+29691657+29691807+29691808+29691809+29691810+29691811+29691814+29691815+29692656+29692676+29694499+29694500+29694501+29697187+29699644+29699645+29699646+29699647+29699648+29699649+29701586+29701587+29701759+29703304+29703305+29703306+29703521+29703563+29704507+29713736+29730793+29730858+29731183+29739902+29770968+29788414+29788415+29788416+29788417+29801477+29801478+29804297+29804298+29804400+29804555,

DM $May1to15fort = 
$resp/29715339+29715340+29715341+29715342+29717727+29723545+29724812+29724813+29727239+29727393+29729264+29731062+29732916+29732917+29734233+29734569+29735268+29735628+29738201+29738203+29739375+29742615+29745019+29745021+29745240+29745243+29745244+29754940+29754941+29756640+29756642+29756643+29757213+29757270+29757271+29757624+29758174+29758176+29758358+29758359+29759047+29760845+29760852+29761429+29761430+29761431+29763284+29763285+29767648+29769574+29770222+29770970+29770971+29771273+29771274+29772120+29772121+29774444+29774445+29774446+29774601+29777109+29780630+29781183+29785400+29793157+29800838+29801270+29811338+29812783+29815061+29833627+29826611+29828881+29842127+29842128+29842576+29848219+29853973+29857160+29857161+29857700+29862258+29862405+29862406+29862407+29862408+29863983+29868231+29868233+29868234+29889592+29889593+29890360+29890361+29890817+29891008+29891009+29893333+29893386+29896937+29896938+29897565+29897571+29897572+29901027+29901028+29908956+29909667+29912212+29912903+29912904+29913681+29914609+29916085+29916086+29916731+29916732+29917229+29923429+29923430+29923432+29936278+29937950+
29727238+29727392+29727394+29728003+29729673+29729674+29729675+29729676+29729677+29729932+29731141+29732313+29732891+29732918+29732919+29739376+29739653+29739654+29740777+29742614+29742616+29745020+29745242+29745396+29745453+29754942+29756641+29757212+29757350+29757623+29758175+29758356+29758357+29760844+29761911+29763282+29763283+29764226+29765632+29765671+29771212+29771214+29771215+29772873+29774447+29774602+29775269+29775270+29775876+29775877+29775878+29777108+29777110+29777111+29777376+29781182+29781185+29781186+29781187+29782501+29782502+29783462+29786292+29786293+29786294+29786295+29789873+29789874+29791628+29792735+29793752+29793753+29799174+29799175+29801267+29801268+29801269+29801271+29801272+29804452+29805645+29805646+29814240+29815058+29815059+29815060+29815493+29815494+29821327+29821328+29821329+29821330+29821651+29832870+
29828882+29842564+29846795+29853974+29857159+29857162+29858743+29858744+29863107+29863108+29863238+29863239+29863982+29879170+29879389+29885175+29885176+29885177+29885947+29886378+29887756+29888493+29889995+29890659+29890660+29890661+29890818+29890819+29891010+29891104+29893347+29893348+29893388+29894436+29895762+29896936+29902685+29902737+29907845+29908957+29909665+29909668+29912838+29915518+29915519+29915520+29916002+29916003+29917228+29917231+29923431+29936634+29936635+29937169+29937170+29937952+29943340+29946758+29947897+29947898+29947899+29984687+29985966+29986501+30030064+30030065+30030066+30032708+30032709,

DM $May16to31fort = 
$resp/29804493+29929079+29932308+29936566+29936567+29936568+29947194+29948208+29948256+29948708+29948709+29952191+29952192+29953081+29953082+29958051+29958052+29958054+29958055+29958056+29958057+29964087+29965856+29965859+29966591+29966592+29967924+29976679+29978380+29979355+29980520+29981812+29981813+29981814+29984243+29984588+29985487+29985637+29985638+29988463+29988519+29988769+29991927+29992919+29992920+29997178+29997179+30003109+30003111+30003482+30004390+30007004+30007644+30007682+30007684+30007686+30007687+30007778+30009034+30011822+30015911+30015969+30015970+30016469+30017228+30021003+30023022+30023024+30023025+30024004+30024492+30031760+30032516+30032754+30032938+30038632+30041771+30043719+30043720+30044314+30054182+30054489+30054490+30062151+30062474+30063686+30068833+30070644+30075415+30075806+30075876+30076415+30076416+30076559+30079704+30080647+30088110+30090197+30090369+30101253+30101254+30102151+30102152+30102875+30102970+30102972+30105348+30107688+30107689+30107775+30108834+30111504+30111525+30111526+30111593+30111596+30111598+30111600+30111603+30111604+30111854+30112307+30112309+30113382+30114550+30114551+30114658+30114797+30114799+30116194+30116316+30116317+30117994+30119103+30119268+30119518+30119795+30121035+30124216+30125435+30130041+30131038+30131039+30137889+30138823+30138824+30147057+30147923+30147924+30147925+30149278+30149534+30149556+30149827+30149828+30150036+30150106+30151307+30153923+30153924+30157630+30158113+30163657+30163658+30163659+30164667+30203817+
29806586+
29928951+29928952+29928953+29929080+29932309+29932310+29932311+29937667+29939657+29942558+29942559+29947193+29947195+29947196+29952193+29955581+29958053+29959580+29959581+29966590+29969921+29972064+29972593+29972603+29972605+29976822+29976823+29981811+29984589+29984590+29984995+29988461+29988464+29988465+29988466+29988518+29988520+29991497+29994124+29997177+29997784+30000433+30003112+30004126+30004259+30007683+30007685+30007776+30007777+30007974+30009032+30009033+30009035+30010965+30010966+30011823+30011824+30011825+30014096+30014099+30015912+30015968+30016285+30016467+30016468+30016713+30017227+30017229+30019214+30019215+30023023+30023966+30023967+30024007+30025258+30027827+30027828+30032755+30032756+30035350+30041259+30041685+30041686+30041772+30041773+30042146+30045014+30045015+30051957+30052627+30054183+30054488+30054491+30056773+30057990+30061000+30061001+30061861+30063685+30063687+30075843+30075844+30075922+30075923+30075997+30075998+30076417+30079705+30080246+30080247+30080248+30080646+30084455+30084456+30084490+30084491+30084939+30084940+30088112+30091852+30091853+30098145+30098146+30098148+30101165+30102874+30102971+30108835+30111082+30111594+30111595+30111597+30111599+30111601+30111602+30111605+30111623+30111853+30112306+30112308+30112486+30112502+30112503+30113312+30113313+30114552+30114553+30114798+30114800+30115004+30115101+30115102+30117995+30118571+30118818+30119044+30119332+30119333+30119334+30119335+30119336+30119487+30119488+30119489+30120667+30120798+30124207+30124218+30124219+30125262+30125263+30125434+30130039+30131036+30131037+30133332+30133333+30133334+30133335+30133336+30133337+30133338+30134624+30134625+30134626+30135144+30135183+30137890+30138772+30138773+30138774+30138775+30138776+30138818+30138819+30138820+30138821+30138822+30140385+30141741+30141742+30141768+30147056+30147442+30147443+30147444+30147854+30147855+30148486+30149279+30149555+30150105+30150355+30150356+30151447+30151448+30153614+30153615+30153922+30157142+30157628+30157629+30158114+30158115+30158116+30163627+30164666+30177790,




dm $q17f_none = $xA_Q17f/1..48+[*doa=1:XBRX][SOEBRANDNONE.a][*sle]+[*enda],
DM $TQ17f = $xA_Q17f/
1+1056,
2+1050+1043,
3+1062,
4+1058+1061,
5+1020,
6+1080,
7+1029,
8+1078,
9,
10+1079,
11+1072,
12+1010,
13+1002,
14+1089,
15,
16+1008+1051,
17,
18+1047,
19+1054,
20,
21,
22+1022,
23+1009+1046+1053+1059,
24+1015,
25+1016+1033+1060,
26+1045,
27,
28+1042+1087,
29+1082,
30,
31,
32+1071,
33,
34,
35,
36+1013,
37,
38,
39,
40,
41,
42+1083,
43,
44,
45,
46,
47,
48,
1001,
1003,
1004+1005+1006+1017,
1007,
1011,
1012,
1014,
1018,
1019+1041,
1021,
1028,
1030,
1031,
1032,
1034,
1035,
1036,
1040,
1044,
1048,
1049,
1052,
1055,
1057,
1063,
1064,
1065,
1066,
1067,
1068,
1069,
1070,
1073,
1074,
1076,
1077,
1081,
1084,
1085,
1086,
1087,
1088,
1090+1092,
1093,
1094,
1096,
1097,
1098,
1099,
1100,
1075+1091+1095,
1075,
1091,
1095,
9998,
(99+9999)+($q17f_none/b),
R,F,
VT = "Q17f. E-WALLET/MOBILE MONEY/ANY FINANCIAL APP OR WEBSITE EVER USED",
V = $TQ16a,



DM $HTOT = 
T,
ht = "Header TOTAL",
h = "
TOTAL",

DM $FS1 = 
$resp/nb,
$resp/nb,
$resp/nb,
$xA_Q194b/1-23,


FINISH DATA,


START TABLES,


!!!!!!!!!!!!!!!!
!!!!!FORMAT!!!!!
!!!!!!!!!!!!!!!!





GLOBAL IT # = '<JL>Wall-E',



!======FOR QPS WINDOWS (% + raw - for datachecking)
F= CTU'='/CAZ'-'/CZP'-'/SDV/UCH/NPGN/NPTC/TID/RLW30/LBB1/TOC/SPL250/CNZ'*'/URS/
  DPR1/PCS/BRS/BCS/PRC/BTS/LPP55/NSER/CLG1/RNC1/NDAT/NPGN/BAL/RBL/BCS/BTS/CLW9/PBL/MOD,

F=SDV,		! ------ PRINT STD DEVIATION
F=DPR4,		! ------ DECIMAL %
F=DPT0,		! ------ DECIMAL RAW COUNT
F=DPA4,		! ------ DECIMAL MEAN,SUM..
F=DPS4,	        ! ------ DECIMAL STD,
F=MOD,		! ------ DISPLAY MODE
F=MED,		! ------ DISPLAY MEDIAN
!F=MCB29,          ! ------ Less than 30 base
F=BTS,                  ! ------ Blank Tables Suppress
F=BCS,                  ! ------ Blank Column Suppress
F=NBRS,                  ! ------ Blank Row Suppress
F=PBL/MOD,

%AVG = 'Mean score<D2>',
%DAT = '<&DD>/<&MONTH>/<&YY>',
%RTH = '<ML3>ROW %',
%RTV = '<ML3>COL %',
%PRC = '<ML3>COUNT',
%SER = '<ML3>STD ERR OF MEAN',
%SDV ='STANDARD DEVIATION',
%PTR = "TOTAL",
!%AVG ='MEAN SCORE',
%SDV ='STANDARD DEVIATION',
%MED = '<ML7>MEDIAN            ',
%UNR = '<ML7>(UNWEIGHTED BASE)',


  
F=SHG-1/SIG/SLA95/SLB95/BRS/FSL,  !---------SIGTEST

!F=NRTV, ! ------- ONLY COUNT
!F=NPRC, ! -------- ONLY %



SELECT WR $newwts,

F=BRS,



[*DATA HX=
HA1_RR,
HE_RR,
HIT,
HLT,
HOT,
HPT]
!





[*SET T = 0]



[*DOX=1:2]
IF $Q76/1+$Q77/1+2, T [+T] = $TH1 * $[HX.X],
BT = "AMONG THE HOUSEHOLD HEAD OR MAIN/CO-DECISION MAKER IN THE HOUSEHOLD",
[*ENDX]



[*DOA=1:3]
[*DOX=1:2]
IF $A_H1/N99.NB, T [+T] = $TH2_[A] * $[HX.X],
BT = "AMONG WHO PREPARES FOR CHRISTMAS",
[*ENDX]
[*ENDA]



[*DOA=1:2]
[*DOX=1:2]
IF ($T_H2_1/N99.N9999.NB)+($T_H2_2/N99.N9999.NB)+($T_H2_3/N99.N9999.NB), T [+T] = $TH3_[A] * $[HX.X],
BT = "AMONG WHO PURCHASE DURING HOLIDAY SEASON",
[*ENDX]
[*ENDA]



[*DOX=1:2]
IF ($T_H2_1/N99.N9999.NB)+($T_H2_2/N99.N9999.NB)+($T_H2_3/N99.N9999.NB), T [+T] = $TH4 * $[HX.X],
BT = "AMONG WHO PURCHASE DURING HOLIDAY SEASON",
[*ENDX]



[*DOX=1:2]
IF ($T_H2_1/N99.N9999.NB)+($T_H2_2/N99.N9999.NB)+($T_H2_3/N99.N9999.NB), T [+T] = $TH5 * $[HX.X],
BT = "AMONG WHO PURCHASE DURING HOLIDAY SEASON",
[*ENDX]


FINISH TABLES,