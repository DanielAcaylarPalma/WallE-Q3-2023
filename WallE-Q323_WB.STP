START CONTROL,
*PROJECT WALL-E
C = P_WALLE_2023Q3.ASC,

Y,
CEP,
CSVR2,
OLDNAMES,
FINISH CONTROL,

START DATA,
ORDER1234567890XV,
SERIAL NUMBER IN COLUMNS 1-10,
CARD CHARACTERS BINARY 300000,
TEMPORARY /99999999/,

DI $RESP = $1-10,

di $blank = 0,
di $Blankamt = $299996-300000,

[*INSERT WallE_insertGlobal]
[*INSERT WallE_oesoe]

[*INSERT WallE_resp]


[*INSERT walle_cardcol_banner]
[*INSERT walle_cardcol_p1]

[*INSERT WallE_insertAlign_pickup]
[*INSERT WallE_insertAlign1]



[*INSERT WallE_stubs_pickup]
[*INSERT WallE_stubs1]

[*INSERT WALL_E_NEWWTS]


DM $MAR2023onwards = 
$resp/28828692+28828693+28828694+28828695+28828696+28830331+28830734+28830735+28830736+28831003+28831004+28832692+28832693+28832694+28832695+28832696+28832697+28832698+28833546+28833547+28834056+28835539+28835540+28835541+28835542+28835543+28839218+28839219+28839220+28839221+28840639+28841761+28841762+28841763+28843542+28843543+28843544+28843545+28843722+28843723+28843724+28843734+28843735+28843736+28844322+28844323+28844324+28844880+28844881+28844882+28844883+28844885+28845128+28845129+28845130+28845131+28845204+28845317+28845318+28845319+28845320+28845366+28845367+28845368+28845468+28845469+28845470+28846724+28846725+28846726+28846727+28846777+28846778+28846779+28847791+28847792+28850500+28850501+28850592+28850593+28850594+28850595+28850596+28850598+28850749+28850750+28850903+28850904+28850905+28850906+28852864+28854110+28854411+28857557+28857558+28857559+28858034+28858035+28858036+28858039+28858040+28858041+28858042+28858219+28858355+28858809+28858811+28858813+28858814+28858816+28858962+28860506+28860954+28863329+28863331+28865891+28865892+28866724+28866725+28866726+28866727+28868131+28868132+28868133+28868134+28868137+28868138+28870046+28870048+28870049+28870180+28870181+28870182+28870183+28870413+28870416+28870417+28870418+28870419+28871347+28871348+28871349+28871350+28871351+28871352+28872277+28873224+28873225+28873226+28873227+28874257+28874258+28874259+28874471+28874472+28874473+28874909+28874910+28874911+28874912+28874913+28875460+28875461+28876126+28876127+28876128+28876129+28876130+28876131+28876132+28876133+28876755+28877453+28877454+28877455+28877456+28877457+28877613+28878115+28878116+28878117+28878118+28878119+28879975+28879976+28879977+28879978+28879979+28879980+28879981+28879982+28880863+28881532+28881533+28881534+28881535+28881536+28881537+28881538+28885018+28885019+28885020+28885500+28885501+28885528+28885529+28886447+28886448+28888652+28888653+28888656+28888834+28888835+28888836+28888837+28889006+28889007+28889008+28889009+28889010+28889011+28889013+28889215+28889216+28889217+28889218+28889334+28889335+28889337+28889338+28889339+28889340+28889342+28889343+28889344+28889595+28890033+28890034+28890035+28891332+28891396+28891397+28891398+28891399+28891400+28891401+28891402+28891403+28891404+28891453+28891454+28899597+28899598+28901390+28901391+28901392+28901492+28901640+28901641+28902426+28902427+28902428+28903428+28903429+28903430+28906110+28906111+28906141+28907664+28907666+28909592+28909593+28913740+28917056+28917057+28917058+28917602+28918036+28918037+28920103+28920104+28920105+28920106+28920646+28920648+28920649+28920650+28920837+28920838+28920839+28920840+28920841+28920842+28920971+28921013+28921014+28921160+28921202+28921203+28921204+28921205+28922238+28924040+28924041+28924042+28927003+28927004+28927005+28927871+28934322+28934508+28934509+28934510+28934996+28934997+28935675+28936139+28936141+28939892+28944015+28945426+28945427+28945428+28946009+28947865+28947866+28949143+28949144+28949145+28949146+28949147+28949148+28949149+28949346+28974940+28974941+28974942+28974943+28977205+28985114+28985116+28987688+28987689+28987691+28992397+28992398+28992399+28992400+28992401+28992695+28992696+28992697+28992698+28992699+28992801+28992917+28992918+28993453+28993454+28993455+28993654+28994309+28994310+28994311+28994312+29009281+29037757+29037758+29045023+29045024+29045026+29052540+29052541+29052542+29054435+29054436+29056959+29056960+29057363+29057364+29057365+29069238+29071526+29071527+29077449+29077450+29077451+29077452+29077454+29078074+29078075+29078076+29078077+29079275+29079660+29080758+29080759+29080760+29080855+29080856+29081309+29081310+29081312+29081313+29081315+29081552+29081836+29081837+29083582+29083586+29085803+29085804+29085805+29085807+29086378+29086379+29086380+29086381+29086382+29086383+29086384+29089845+29089846+29089847+29089848+29092253+29092254+29093392+29094117+29094118+29094119+29094540+29094541+29094542+29094543+29094918+29095894+29095917+29095918+29096083+29096084+29096085+29096086+29096288+29096869+29096870+29097435+29097436+29097437+29097527+29097528+29098557+29099874+29099875+29099876+29099877+29099878+29100249+29100250+29100251+29101081+29101082+29103589+29103645+29103848+29104589+29104590+29104591+29104592+29106847+29111100+29111161+29111162+29111163+29118730+29119010+29119011+29119652+29119653+29123378+29123379+29123380+29128644+29128645+29128697+29128698+29128849+29131271+29131272+29131273+29131612+29132579+29132580+29132581+29132582+29132636+29134810+29134811+29134812+29134813+29137837+29138614+29138615+29139189+29141798+29141799+29141800+29141801+29145984+29145985+29145986,


!===================================================================================================================================
! $TOM - define codes TOM - order based on data set
! $OTH - define codes OTHER SPONT - order based on data set
! $AID - define codes AIDED/PROMPTED - order based on data set
! $BUMO - define codes BUMO - order based on data set
! $CONS - define codes CONSIDERER by brand (code 1+2) - order based on data set
! $FFAVE - define codes 1st FAVOURITE - order based on data set
! $SFAVE - define codes 2nd FAVOURITE - order based on data set
! $RECO - define codes RECOMMENDERS - order based on data set
!===================================================================================================================================
[*data BR1 (;) =
BDO Mobile/Online (NET);
BDO Mobile/Online;
BDO Pay;
BPI Mobile/Online;
CLIQQ;
Coins.ph;
GCash;
GrabPay;
PayMaya;
PayPal;
ShopeePay]


DM $TOM = $xQ16a/
(13+1002+22+1022),
(13+1002),
(22+1022),
(12+1010),
11+1072,
3+1062,
1+1056,
(7+1029),
(2+1050+1043),
(4+1058+1061),
(23+1009+1046+1053+1059),



DM $OTH = $xA_Q16b/
(13+1002+22+1022),
(13+1002),
(22+1022),
(12+1010),
11+1072,
3+1062,
1+1056,
(7+1029),
(2+1050+1043),
(4+1058+1061),
(23+1009+1046+1053+1059),

DM $AID = $xA_Q16c/
(13+1002+22+1022),
(13+1002),
(22+1022),
(12+1010),
11+1072,
3+1062,
1+1056,
(7+1029),
(2+1050+1043),
(4+1058+1061),
(23+1009+1046+1053+1059),

DM $BUMO = $xQ17b/
(13+1002+22+1022),
(13+1002),
(22+1022),
(12+1010),
11+1072,
3+1062,
1+1056,
(7+1029),
(2+1050+1043),
(4+1058+1061),
(23+1009+1046+1053+1059),


DM $XP2M = $xA_Q17a/(13+1002+22+1022),
(13+1002),
(22+1022),
(12+1010),
11+1072,
3+1062,
1+1056,
(7+1029),
(2+1050+1043),
(4+1058+1061),
(23+1009+1046+1053+1059),



DM $V45R1 = $TQ45R13 .or. $TQ45R22,
DM $V45R2 = $TQ45R13,
DM $V45R3 = $TQ45R22,
DM $V45R4 = $TQ45R12,
DM $V45R5 = $TQ45R11,
DM $V45R6 = $TQ45R3,
DM $V45R7 = $TQ45R1,
DM $V45R8 = $TQ45R7,
DM $V45R9 = $TQ45R2,
DM $V45R10= $TQ45R4,
DM $V45R11= $TQ45R23,


DM $CONS = [*DOA=1:11]
           $V45R[a]/1..2,
           [*end a]

DM $FFAVE = $xQ16e/
(13+1002+22+1022),
(13+1002),
(22+1022),
(12+1010),
11+1072,
3+1062,
1+1056,
(7+1029),
(2+1050+1043),
(4+1058+1061),
(23+1009+1046+1053+1059),

DM $SFAVE = $xQ16f/
(13+1002+22+1022),
(13+1002),
(22+1022),
(12+1010),
11+1072,
3+1062,
1+1056,
(7+1029),
(2+1050+1043),
(4+1058+1061),
(23+1009+1046+1053+1059),

DM $RECO = $xQ16g/
(13+1002+22+1022),
(13+1002),
(22+1022),
(12+1010),
11+1072,
3+1062,
1+1056,
(7+1029),
(2+1050+1043),
(4+1058+1061),
(23+1009+1046+1053+1059),

!===================================================================================================================================
! Price Premium (edit loop based on number of brands)
!===================================================================================================================================

[*data 4601 = 13,22]

[*do c = 1:2]
DI $BDO[c] = 0,
if $xT_Q46_[4601.c]/1, DI $BDO[c] = 1,
if $xT_Q46_[4601.c]/2, DI $BDO[c] = 2,
if $xT_Q46_[4601.c]/3, DI $BDO[c] = 3,
if $xT_Q46_[4601.c]/4, DI $BDO[c] = 4,
if $xT_Q46_[4601.c]/5, DI $BDO[c] = 5,
if $xT_Q46_[4601.c]/6, DI $BDO[c] = 6,
[*end c]

DI $BDO_T = [*do c = 1:2]$BDO[c][*sle]+[*end c],

DI $BDO_C = 0,
[*do c = 1:2]
IF $BDO[c]/nb, DI $BDO_C = $BDO_C + 1,
[*end c]

DI $PP1 = $BDO_T / $BDO_C,
DM $PP2 = $xT_Q46_13,
DM $PP3 = $xT_Q46_22,
DM $PP4 = $xT_Q46_12,
DM $PP5 = $xT_Q46_11,
DM $PP6 = $xT_Q46_3,
DM $PP7 = $xT_Q46_1,
DM $PP8 = $xT_Q46_7,
DM $PP9 = $xT_Q46_2,
DM $PP10= $xT_Q46_4,
DM $PP11= $xT_Q46_23,

[*DO A = 1:1]
[*FOR b = 1:3:4:5:6:7:8:10:11:12:13:14:16:17:20:21:22:23:24:25:26:27:28:29:30]
IF $xT_Q64_[B]/[a],    DI $Brand1_Attr[b] = 1,
[*end b]
[*END A]

[*DO A = 2:2] !bdo online
[*FOR b = 1:3:4:5:6:7:8:10:11:12:13:14:16:17:20:21:22:23:24:25:26:27:28:29:30]
IF ($A_Q16d/13+1002).$xT_Q64_[B]/[a-1],  DI $Brand2_Attr[b] = 1,
[*end b]
[*END A]

[*DO A = 3:3] !bdo pay
[*FOR b = 1:3:4:5:6:7:8:10:11:12:13:14:16:17:20:21:22:23:24:25:26:27:28:29:30]
IF ($A_Q16d/22+1022).$xT_Q64_[B]/[a-2],      DI $Brand3_Attr[b] = 1,
[*end b]
[*END A]

[*DO A = 4:11]
[*FOR b = 1:3:4:5:6:7:8:10:11:12:13:14:16:17:20:21:22:23:24:25:26:27:28:29:30]
IF $xT_Q64_[B]/[a-2],               DI $Brand[a]_Attr[b] = 1,
[*end b]
[*END A]



!===================================================================================================================================
!**********  START OF PUNCHING **********
! edit all columns allocation accordingly
! edit loop based on number of brands
! adjust loop of brand association
!===================================================================================================================================





!------------------------------------------------------------- START OF PUNCHING

[*do a = 1:11]

DI $RespNo = $1-10, !- serial or respid
DI $BRANDS = [A], !- brand code

IF $TOM/[A],                      					DI $Aware = 4,       ! TOM
IF $TOM/n[A].$OTH/[A],            					DI $Aware = 3,       ! UNAIDED
IF $TOM/n[A].$OTH/n[A].$AID/[A],  					DI $Aware = 2,       ! AIDED
IF $TOM/n[A].$OTH/n[A].$AID/n[A], 					DI $Aware = 1,       ! NOT AWARE


!! == CONSIDER BRANDS - (CONSIDER BUYING+1ST+2ND FAVORITE+BUMO) == !!

IF $cons/[A]+$FFAVE/[A]+$SFAVE/[A]+$bumo/[A],    	DI $Consider = 1,     	 ! CONSIDER
IF $cons/n[A].$FFAVE/n[A].$SFAVE/n[A].$bumo/n[A],	DI $Consider = 0,     	 ! NOT CONSIDER


!! == PREFER BRANDS - (FIRST FAVORITE/2ND FAVORITE) == !!

IF $FFAVE/[A],                                      DI $Favrite = 3,         ! IF 1ST FAVORITE BRAND
IF $FFAVE/n[A].$SFAVE/[A],                          DI $Favrite = 2,         ! IF 2ND FAVORITE BRAND
IF $FFAVE/n[A].$SFAVE/n[A],                         DI $Favrite = 1,         ! IF NEITHER 1 NOR 2 FAVORITE


!! == RECOMMENDED BRANDS == !!

IF $reco/[A],                                       DI $Recmnd = 1,      	 ! RECOMMEND
IF $reco/n[A],                                      DI $Recmnd = 0,      	 ! NOT RECOMMEND

!! == RECOMMENDED BRANDS == !!

IF $XP2M/[A],                                       DI $P2M = 1,      	 ! RECOMMEND
IF $XP2M/n[A],                                      DI $P2M = 0,      	 ! NOT RECOMMEND




!! == PRICE PREMIUM == !!
! Note: This will only apply if highest code in questionnaire has the most negative stub. If not do not reverse scale
!-----------------------------------------------------------------------------------------------------------------------

IF $PP[A]/1,            	DW $Premium = 1.00,      ! I WOULDN`'T BUY IT AT ALL - NO ANSWER IN DATA TABLES - NOT INCLUDED
IF $PP[A]/2,            	DW $Premium = 2.00,      ! BUY WHEN PRICE IS THE SAME AS THE CHEAPEST BRAND
IF $PP[A]/3,            	DW $Premium = 3.00,      ! BUY EVEN IF IT IS A LITTLE EXPENSIVE THAN THE CHEAPEST BRAND
IF $PP[A]/4,            	DW $Premium = 4.00,      ! BUY EVEN IF IT IS SO MUCH MORE EXPENSIVE THAN THE CHEAPEST BRAND
IF $PP[A]/5,            	DW $Premium = 5.00,      ! BUY EVEN IF IT IS EXPENSIVE THAN OTHER BRANDS
IF $PP[A]/6,            	DW $Premium = 6.00,      ! BUY IT NO MATTER WHAT THE PRICE
						
IF $PP[A]/B.$Consider/0, 	DW $Premium = 1.00,		 ! IF NOT CONSIDERED TO BUY
IF $PP[A]/B.$Consider/1, 	DW $Premium = 3.00,		 ! IF CONSIDERED TO BUY
IF $PP[A]/B.$Recmnd/1, 		DW $Premium = 3.25,		 ! IF RECOMMENDED BRAND

[*FOR B = 1:3:4:5:6:7:8:10:11:12:13:14:16:17:20:21:22:23:24:25:26:27:28:29:30]
IF $Brand[A]_Attr[b]/1, DI $Attr[B] = 1,
IF $Brand[A]_Attr[b]/n1, DI $Attr[B] = 0,
[*END b] 

!! == SEGMENTS / FILTERS == !!

if $Q3/1,                   DI $AREA = 1,
if $Q3/2+3+4+5,             DI $AREA = 2,
if $Q3/6+7+8,               DI $AREA = 3,
if $Q3/9+10+11,             DI $AREA = 4,
if $Q3/12+13+14+15+16+17,   DI $AREA = 5,

if $Q4/1,   DI $LOCALE = 1,
if $Q4/2,   DI $LOCALE = 2,

if $xQ102/1,   DI $SEC = 1,
if $xQ102/2,   DI $SEC = 2,
if $xQ102/3,   DI $SEC = 3,
if $xQ102/4,   DI $SEC = 4,

if $QAgeRange/1,   DI $AGE_RANGE = 1,
if $QAgeRange/2,   DI $AGE_RANGE = 2,
if $QAgeRange/3,   DI $AGE_RANGE = 3,
if $QAgeRange/4,   DI $AGE_RANGE = 4,
if $QAgeRange/5,   DI $AGE_RANGE = 5,

if $Q2/1,          DI $GENDER = 1,
if $Q2/2,          DI $GENDER = 2,

if $T_Q1_1/1..21,    DI $LIFESTAGE = 1,
if $T_Q1_1/22..29,   DI $LIFESTAGE = 2,
if $T_Q1_1/30..34,   DI $LIFESTAGE = 3,
if $T_Q1_1/35..44,   DI $LIFESTAGE = 4,
if $T_Q1_1/45..99,   DI $LIFESTAGE = 5,

if $xSEC21/1,   DI $WORKING_STAT = 1,
if $xSEC21/2,   DI $WORKING_STAT = 2,

if $xQ17i/1,   DI $USERSHIP = 1,
if $xQ17i/2,   DI $USERSHIP = 2,

if $TQ17e/1,  DI $GCASH_USER = 1,
if $TQ17e/N1, DI $GCASH_USER = 2,

[*DO D = 1:3]
if $Q72/[D], DI $BANK_CON = [D],
[*END D]

[*DO D = 1:17]
if $Q3/[D], DI $REGION = [D],
[*END D]


if ($Q3/1).($Q4/1),                   DI $AREAXLOC = 1,
if ($Q3/2+3+4+5).($Q4/1),             DI $AREAXLOC = 2,
if ($Q3/6+7+8).($Q4/1),               DI $AREAXLOC = 3,
if ($Q3/9+10+11).($Q4/1),             DI $AREAXLOC = 4,
if ($Q3/12+13+14+15+16+17).($Q4/1),   DI $AREAXLOC = 5,

if ($Q3/1).($Q4/2),                   DI $AREAXLOC = 6,
if ($Q3/2+3+4+5).($Q4/2),             DI $AREAXLOC = 7,
if ($Q3/6+7+8).($Q4/2),               DI $AREAXLOC = 8,
if ($Q3/9+10+11).($Q4/2),             DI $AREAXLOC = 9,
if ($Q3/12+13+14+15+16+17).($Q4/2),   DI $AREAXLOC = 10,

[*DATA Q8blabel =
Online,
Offline,
DidNotDo]

[*DO D = 1:3]
[*DO E = 1:12]
If $TQ8bR[D]/[E], DI $TQ8b[Q8blabel.D] = [E],
[*END E]
[*END D]

[*DO E = 1:12]
If $TQ8br1/[E]+$TQ8br2/[E], DI $Q8bR[E]both = 1,
If ($TQ8br1/N[E].$TQ8br2/N[E]), DI $Q8bR[E]both = 0,
[*END E]

[*DO E = 1:12]
If $TQ8br1/[E], DI $Q8bR[E]online = 1,
If ($TQ8br1/N[E]), DI $Q8bR[E]online = 0,
[*END E]

[*DO E = 1:12]
If $TQ8br2/[E], DI $Q8bR[E]offline = 1,
If ($TQ8br2/N[E]), DI $Q8bR[E]offline = 0,
[*END E]

[*DO D = 1:BRX+2]
If $TQ17a/[D], DI $TQ17a_P2M_ALL = [D],
[*END D]

[*DO D = 1:BR]
! if $TQ27R[D]/ = $TQ27_brand[D] = 
[*END D]

If $Apr2023/NB, DI $Month = 4,
If $May2023/NB, DI $Month = 5,
If $Jun2023/NB, DI $Month = 6,

LCSV (H) $RespNo.$Brands.$Aware.$Consider.$Favrite.$Recmnd.$Premium.$P2M.
[*FORB=1:3:4:5:6:7:8:10:11:12:13:14:16:17:20:21:22:23:24:25:26:27:28:29:30]
$Attr[B].
[*ENDB]
$AREA.$LOCALE.$SEC.$AGE_RANGE.$GENDER.$LIFESTAGE.$WORKING_STAT.$USERSHIP.$GCASH_USER.$BANK_CON.$REGION.$AREAXLOC.
$NEWWTS,
[*END A]




FINISH DATA,




